{namespace vhs = FluidTYPO3\Vhs\ViewHelpers}

<f:form action="update" controller="Mitarbeiter" arguments="{mitarbeiter:mitarbeiter, key:key, berechtigung:berechtigung}" additionalAttributes="{role: 'form'}" >  
    <!-- TODO: Buttons for Qualification categories -->
    <ul class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link active" id="catAll">All</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" id="catActive">Active</a>
        </li>
        <f:for each="{categories -> vhs:iterator.sort(sortBy: 'category.name')}" as="category">
            <li class="nav-item">
                <a class="nav-link active" id="cat{category.name}">{category.name}</a>
            </li>
            <!-- <input type="button" class="btn btn-sm btn-secondary" value="{category.name}" /> -->
        </f:for>
    </ul>
    <table>
        <td class="tx-staffm bold">Name:&nbsp;</td><td>{mitarbeiter.LastName} {mitarbeiter.firstName}</td><br />
    </table>            
    <table  class="tx_staffm" >
        <tr>                        
            <th><f:translate key="tx_staffm_domain_model_qualifikation.bezeichnung" /></th> 
        <th><f:translate id="staffm.active" /></th>
        <th><f:translate key="tx_staffm_domain_model_employeequalification.status" /></th>
        <th><f:translate key="tx_staffm_domain_model_employeequalification.reminder_date" /></th>
        <th><f:translate key="tx_staffm_domain_model_employeequalification.note" /></th>
        </tr>
        <f:for each="{qualifikations}" as="qualifikation">
            <tr>                            
            <f:if condition="{tv:quali(m:mitarbeiter, qu: qualifikation)} > 0">
                <f:then>                       
                    <td class="td{qualifikation.uid}" style="background-color: red">{qualifikation.bezeichnung}</td>                                         
                    <td class="td{qualifikation.uid}" style="background-color: red"><f:form.checkbox id="qualiCheck{qualifikation.uid}" additionalAttributes="{onClick:'setCheckbox(this);'}" name="qualifikationen" value="{qualifikation.uid}" multiple="1" checked="1" /></td>                                 
                    <td class="td{qualifikation.uid}" style="background-color: red"><f:form.select id="qualiSelect{qualifikation.uid}" name="qualificationsstatus[{qualifikation.uid}]" options="{qualifikation.status}" value="{tv:qualiStatus(mitarbeiter:mitarbeiter, qualifikation:qualifikation)}" /></td>                                 
                    <td class="td{qualifikation.uid}" style="background-color: red"><f:form.textfield id="qualiReminderDate{qualifikation.uid}" name="qualificationsreminderdate[{qualifikation.uid}]" value="{tv:qualiReminderDate(mitarbeiter:mitarbeiter, qualifikation:qualifikation)}" additionalAttributes="{onclick:'datepicker(this);'}" readonly="TRUE" />&nbsp;<a title="Delete date" style="cursor:pointer" id="qualiReminderDeleteDate{qualifikation.uid}" onclick="delteReminderDate(this);"><f:image src="typo3conf/ext/Staffm/Resources/Public/Icons/icon_delete.svg" width="15" /></a></td>
                    <td class="td{qualifikation.uid}" style="background-color: red"><f:form.textarea id="qualiText{qualifikation.uid}" name="qualificationsnotes[{qualifikation.uid}]" value="{tv:qualiNote(mitarbeiter:mitarbeiter, qualifikation:qualifikation)}" /></td>
                    <td style="display:none"><f:form.textarea id="cattext{qualifikation.uid}" class="cattexts" value="{f:if(condition: i.isLast, then: '{category.name}', else: '{category.name},') -> f:for(each:'{qualifikation.categories}', as: 'category', iteration: 'i')}" /></td>
                </f:then>
                <f:else>
                    <td class="td{qualifikation.uid}">{qualifikation.bezeichnung}</td>                                         
                    <td class="td{qualifikation.uid}"><f:form.checkbox id="qualiCheck{qualifikation.uid}" additionalAttributes="{onClick:'setCheckbox(this);'}" name="qualifikationen" value="{qualifikation.uid}" multiple="1" checked="0" /></td>                                 
                    <td class="td{qualifikation.uid}"><f:form.select id="qualiSelect{qualifikation.uid}" name="qualificationsstatus[{qualifikation.uid}]" options="{qualifikation.status}" value="" disabled="TRUE" /></td>
                    <td class="td{qualifikation.uid}"><f:form.textfield id="qualiReminderDate{qualifikation.uid}" name="qualificationsreminderdate[{qualifikation.uid}]" value="" additionalAttributes="{onclick:'datepicker(this);'}" disabled="TRUE" readonly="TRUE" />&nbsp;<a title="Delete date" style="cursor:pointer" id="qualiReminderDeleteDate{qualifikation.uid}" onclick="delteReminderDate(this);"><f:image src="typo3conf/ext/Staffm/Resources/Public/Icons/icon_delete.svg" width="15" /></a></td>
                    <td class="td{qualifikation.uid}"><f:form.textarea id="qualiText{qualifikation.uid}" name="qualificationsnotes[{qualifikation.uid}]" value="" disabled="TRUE" /></td>
                    <td style="display:none"><f:form.textarea id="cattext{qualifikation.uid}" class="cattexts" value="{f:if(condition: i.isLast, then: '{category.name}', else: '{category.name},') -> f:for(each:'{qualifikation.categories}', as: 'category', iteration: 'i')}" /></td>
                </f:else>
            </f:if>
            </tr>
        </f:for>
    </table>
    <br />
    <div class="btn-group" role="group">
        <f:link.action class="btn btn-secondary" action="edit" controller="Mitarbeiter" arguments="{mitarbeiter:mitarbeiter, berechtigung:berechtigung}"><f:translate id="staffm.back" /></f:link.action>
        <button class="btn btn-success" type="submit"><f:translate id="staffm.choose" /> <f:translate id="staffm.text.uebergeben" /></button><!--<f:form.submit class="btn btn-default" value="Auswahl Ã¼bergeben" />-->
    </div>
    <!-- TODO: JavaScript for show/hide qualifications -->    
</f:form>